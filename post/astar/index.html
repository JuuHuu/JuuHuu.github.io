<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: April 14, 2024 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.7" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.f6689966c0a10712f95f034011917db0.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  






<script async src="https://www.googletagmanager.com/gtag/js?id=G-37HENQ373L"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-37HENQ373L', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>
























  
  
  






  <meta name="author" content="Jun Hu" />





  

<meta name="description" content="this article provide an A* code  implemented by MATLAB" />



<link rel="alternate" hreflang="en-us" href="https://juuhuu.github.io/post/astar/" />
<link rel="canonical" href="https://juuhuu.github.io/post/astar/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu7db9054e36068c46bdf41746b47a34b6_4348_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu7db9054e36068c46bdf41746b47a34b6_4348_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@GetResearchDev" />
  <meta property="twitter:creator" content="@GetResearchDev" />
<meta property="twitter:image" content="https://juuhuu.github.io/media/icon_hu7db9054e36068c46bdf41746b47a34b6_4348_512x512_fill_lanczos_center_3.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="Juu&#39;s" />
<meta property="og:url" content="https://juuhuu.github.io/post/astar/" />
<meta property="og:title" content="A* Algorithm Using MATLAB | Juu&#39;s" />
<meta property="og:description" content="this article provide an A* code  implemented by MATLAB" /><meta property="og:image" content="https://juuhuu.github.io/media/icon_hu7db9054e36068c46bdf41746b47a34b6_4348_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2024-04-08T15:58:05&#43;08:00"
    />
  
  
    <meta property="article:modified_time" content="2024-04-14T15:58:05&#43;08:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://juuhuu.github.io/post/astar/"
  },
  "headline": "A* Algorithm Using MATLAB",
  
  "datePublished": "2024-04-08T15:58:05+08:00",
  "dateModified": "2024-04-14T15:58:05+08:00",
  
  "author": {
    "@type": "Person",
    "name": "Jun Hu"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Juu's",
    "logo": {
      "@type": "ImageObject",
      "url": "https://juuhuu.github.io/media/icon_hu7db9054e36068c46bdf41746b47a34b6_4348_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "this article provide an A* code  implemented by MATLAB"
}
</script>

  

  




  
  
  

  
  

  


  
  <title>A* Algorithm Using MATLAB | Juu&#39;s</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll"  data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="e9f2111f4cf00f0c01bd1dfc809f12c7" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.9e4214442a7711d35691acd58f6f6361.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Juu&#39;s</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Juu&#39;s</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/post"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/project"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/publication"><span>Publications</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    
<div class="container-fluid docs">
    <div class="row flex-xl-nowrap">
      <div class="d-none d-xl-block col-xl-2 docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
        </ul>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#graph-nodes-and-edges">Graph, Nodes and Edges</a></li>
      </ul>
    </li>
    <li><a href="#algorithms">Algorithms</a>
      <ul>
        <li>
          <ul>
            <li><a href="#breadth-first-search">Breadth First Search</a></li>
            <li><a href="#dijkstras-algorithm">Dijkstra&rsquo;s Algorithm</a></li>
            <li><a href="#heuristic-search-greedy-best-first-search">Heuristic search (Greedy Best First Search)</a></li>
            <li><a href="#a-algorithm">A* algorithm</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
        
      </div>
      <main class="col-12 col-md-0 col-xl-10 py-md-3 pl-md-5 docs-content" role="main">

        <article class="article">
            













  

  
  
  
<div class="article-container pt-3">
  <h1>A* Algorithm Using MATLAB</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Apr 14, 2024
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  
  

  
  

</div>

    





  
</div>


            <div class="article-container">
              <div class="article-style">
                <h2 id="introduction">Introduction</h2>
<p>A* was first proposed to plan a mobile robot actions, but it has been shown applicable to any problem that satisfying the conditions of a cost algebra.This article introduced A* and implemented using MATLAB.</p>
<h3 id="graph-nodes-and-edges">Graph, Nodes and Edges</h3>
<p>A* is a kind of graph search algorithm, the graph search algorithm takes a graph as input. The graph consists of some &ldquo;nodes&rdquo; and &ldquo;edges&rdquo;. Nodes represet possible configurations (positions, joint angles, etc.), while edges connect two transferable nodes. The weight (cost) of edges represent the cost transfer from one node to another. Graph is illustrated in Figure 1.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="nodes and edges" srcset="
               /post/astar/nodesandedges_hufc678914c8d803ac9d7a9346a32329ea_3739626_584cff6dd92d00b7ad3dfbdbd095d30f.webp 400w,
               /post/astar/nodesandedges_hufc678914c8d803ac9d7a9346a32329ea_3739626_d465eac4954e0341e21190bac31f4ac7.webp 760w,
               /post/astar/nodesandedges_hufc678914c8d803ac9d7a9346a32329ea_3739626_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/nodesandedges_hufc678914c8d803ac9d7a9346a32329ea_3739626_584cff6dd92d00b7ad3dfbdbd095d30f.webp"
               width="760"
               height="587"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p><em>Figure 1. Graph</em>, where nodes with blue outline represents start, with red represents goals, numbers around edges represents costs</p>
<p>For example, when planning robotics motion, the nodes represent locations that a robotics can reach, edges represent possible path a robot can move from one nodes to others, cost represent the distance. While doing motion plan, the nodes represent possible joint configuration, and edges represent possible transfer path between joints&rsquo; configuration.</p>
<h2 id="algorithms">Algorithms</h2>
<p>After representing the problem using Graph, the next step is to implement search. There are lots of algorithms run on graphs, here we will explore three of them: Breadth First Search, Dijkstra&rsquo;s Algorithm, and A*.</p>
<h4 id="breadth-first-search">Breadth First Search</h4>
<p><em>Breadth First Search</em> algorithm explores equally in all directions, which means the cost (weight) of edges are all equal. The key ideal for <em>Breadth First Search</em> algorithm is to maintain a &lsquo;frontier&rsquo; variable that record the most front nodes.</p>
<p>The pseudocode is shown below:</p>
<ol>
<li>Initial parameters</li>
<li>Add starting nodes to <em><strong>frontier</strong></em></li>
<li>repeat following until <em><strong>frontier</strong></em> is empty</li>
<li>Move the first element of <em><strong>frontier</strong></em> to <em><strong>current node</strong></em></li>
<li>Find the <em><strong>neighbors</strong></em> of <em><strong>current node</strong></em></li>
<li>If <em><strong>neighbors</strong></em> is not in <em><strong>reached</strong></em>
<ol>
<li>add <em><strong>neighbors</strong></em> to <em><strong>reached</strong></em></li>
<li>add <em><strong>neighbors</strong></em> to the end of <em><strong>frontier</strong></em></li>
</ol>
</li>
<li>end repeat</li>
</ol>
<p>The MATLAB code is shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="c">%step 1,2</span>
</span></span><span class="line"><span class="cl"><span class="n">frontier</span><span class="p">={};</span><span class="c">% define the frontier nodes</span>
</span></span><span class="line"><span class="cl"><span class="n">frontier</span><span class="p">{</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">}=</span><span class="n">star_node</span><span class="p">;</span> <span class="c">% initial the start nodes as the first frontier</span>
</span></span><span class="line"><span class="cl"><span class="n">reached</span><span class="p">=[];</span> <span class="c">% define reached nodes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">%step 3</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">~</span><span class="nb">isempty</span><span class="p">(</span><span class="n">frontier</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">%step 4</span>
</span></span><span class="line"><span class="cl">    <span class="n">current</span> <span class="p">=</span> <span class="n">frontier</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span> <span class="c">% add the first elements of frontier to current</span>
</span></span><span class="line"><span class="cl">    <span class="n">frontier</span><span class="p">(</span><span class="mi">1</span><span class="p">)=[];</span> <span class="c">% remove the first elements of frontier</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">%plot the current nodes and denoted as green.</span>
</span></span><span class="line"><span class="cl">    <span class="n">plotnodes</span><span class="p">(</span><span class="n">current</span><span class="p">,</span><span class="n">nodes_positions</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">%step 5</span>
</span></span><span class="line"><span class="cl">    <span class="c">%find the neighbors of current nodes</span>
</span></span><span class="line"><span class="cl">    <span class="n">next_node</span><span class="p">=</span><span class="n">neighbors</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">current</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">%step 6</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">next_node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">~</span> <span class="n">ismember</span><span class="p">(</span><span class="n">next_node</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">reached</span><span class="p">)</span> <span class="c">% if neighbor nodes is not in the reached set</span>
</span></span><span class="line"><span class="cl">            <span class="n">frontier</span><span class="p">{</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">}=</span><span class="n">next_node</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span> <span class="c">% add neighbor nodes to frontier</span>
</span></span><span class="line"><span class="cl">            <span class="n">reached</span><span class="p">=</span><span class="n">unique</span><span class="p">([</span><span class="n">next_node</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">reached</span><span class="p">]);</span>  <span class="c">% add neighbor nodes to reached</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="n">input</span><span class="p">(</span><span class="s">&#39;Press any key to continue...\n&#39;</span><span class="p">);</span> <span class="c">% waiting user&#39;s action, to show each explore step</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><p>An animation showing the explore steps is shown below. Green nodes represent <em><strong>reached</strong></em> node. You can see all nodes gradually been explored.</p>
<html>
<video id="myVideo" controls>
  <source src="breadth.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
<script>
// Set video playback speed here
document.addEventListener("DOMContentLoaded", function() {
  var video = document.getElementById("myVideo");
  video.playbackRate = 0.1;
});
</script>
</html>
<p>However, we can only visit all the node in graph. NO path information is provided till now. To return path information, modify the loop by replace the <em><strong>reached</strong></em> to a dictionary <em><strong>came_from</strong></em>, where the key are previous <em><strong>reached</strong></em> node and value are where the key came from.</p>
<p>The peudocode is shown below:</p>
<ol>
<li>Initial parameters</li>
<li>Add starting nodes to <em><strong>frontier</strong></em></li>
<li>repeat following until <em><strong>frontier</strong></em> is empty</li>
<li>Move the first element of <em><strong>frontier</strong></em> to <em><strong>current node</strong></em></li>
<li>Find the <em><strong>neighbors</strong></em> of <em><strong>current node</strong></em></li>
<li>If <em><strong>neighbors</strong></em> is not in <em><strong>came_from</strong></em>
<ol>
<li><em><strong>fame_from[neighbors]</strong></em>=<em><strong>current</strong></em></li>
<li>add <em><strong>neighbors</strong></em> to the end of <em><strong>frontier</strong></em></li>
</ol>
</li>
<li>end repeat</li>
</ol>
<p>The Matlab code is shown below</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="c">% clear previous variables</span>
</span></span><span class="line"><span class="cl"><span class="n">clear</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% %initial random graphs</span>
</span></span><span class="line"><span class="cl"><span class="c">% n=40; % nodes numbe</span>
</span></span><span class="line"><span class="cl"><span class="c">% e=1.1*n; % edges number</span>
</span></span><span class="line"><span class="cl"><span class="c">% G = graph(true(n), &#39;omitselfloops&#39;);</span>
</span></span><span class="line"><span class="cl"><span class="c">% p=randperm(numedges(G),e);</span>
</span></span><span class="line"><span class="cl"><span class="c">% G=graph(G.Edges(p,:));</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">% %initial node positions</span>
</span></span><span class="line"><span class="cl"><span class="c">% nodePositions=randi(100,n,2);</span>
</span></span><span class="line"><span class="cl"><span class="c">% distance=nodePositions(:,1).^2+nodePositions(:,2).^2;</span>
</span></span><span class="line"><span class="cl"><span class="c">% [~,sortIndex]=sort(distance);</span>
</span></span><span class="line"><span class="cl"><span class="c">% nodePositions=nodePositions(sortIndex,sortIndex);</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">% %plot graphs</span>
</span></span><span class="line"><span class="cl"><span class="c">% figure;</span>
</span></span><span class="line"><span class="cl"><span class="c">% plot(G,&#39;XData&#39;, nodePositions(:,1), &#39;YData&#39;, nodePositions(:,2), &#39;NodeLabel&#39;, 1:n);</span>
</span></span><span class="line"><span class="cl"><span class="c">% hold on;</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">% % Highlight the start node (assuming startNode is the ID of the start node)</span>
</span></span><span class="line"><span class="cl"><span class="c">% plot(nodePositions(1,1), nodePositions(1,2), &#39;go&#39;, &#39;MarkerSize&#39;, 10, &#39;LineWidth&#39;, 2);</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">% % Highlight the goal node (assuming goalNode is the ID of the goal node)</span>
</span></span><span class="line"><span class="cl"><span class="c">% plot(nodePositions(n,1), nodePositions(n,2), &#39;ro&#39;, &#39;MarkerSize&#39;, 10, &#39;LineWidth&#39;, 2);</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">% hold off;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">%---- Initial graphs -------</span>
</span></span><span class="line"><span class="cl"><span class="c">%preset node positions</span>
</span></span><span class="line"><span class="cl"><span class="n">nodes_positions</span><span class="p">=[</span><span class="o">-</span><span class="mf">0.5</span>	<span class="o">-</span><span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">   <span class="o">-</span><span class="mf">0.09</span>	<span class="o">-</span><span class="mf">0.4</span>
</span></span><span class="line"><span class="cl">   <span class="o">-</span><span class="mf">0.285</span>	<span class="o">-</span><span class="mf">0.305</span>
</span></span><span class="line"><span class="cl">   <span class="mf">0.0575</span>	<span class="o">-</span><span class="mf">0.225</span>
</span></span><span class="line"><span class="cl">   <span class="o">-</span><span class="mf">0.0525</span>	<span class="o">-</span><span class="mf">0.0175</span>
</span></span><span class="line"><span class="cl">   <span class="o">-</span><span class="mf">0.37</span>	<span class="mf">0.3</span>
</span></span><span class="line"><span class="cl">   <span class="mf">0.3525</span>	<span class="o">-</span><span class="mf">0.0525</span>
</span></span><span class="line"><span class="cl">   <span class="mf">0.0625</span>	<span class="mf">0.255</span>
</span></span><span class="line"><span class="cl">   <span class="o">-</span><span class="mf">0.1</span>	<span class="mf">0.3725</span>
</span></span><span class="line"><span class="cl">   <span class="mf">0.4275</span>	<span class="mf">0.195</span>
</span></span><span class="line"><span class="cl">   <span class="mf">0.345</span>	<span class="mf">0.3525</span>
</span></span><span class="line"><span class="cl">   <span class="mf">0.5</span>	<span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">   <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% preset edges and costs</span>
</span></span><span class="line"><span class="cl"><span class="n">edges</span><span class="p">=[</span><span class="mi">12</span>	<span class="mi">11</span>	<span class="mf">0.214</span>
</span></span><span class="line"><span class="cl"><span class="mi">12</span>	<span class="mi">10</span>	<span class="mf">0.3135</span>
</span></span><span class="line"><span class="cl"><span class="mi">12</span>	<span class="mi">8</span>	<span class="mf">0.5014</span>
</span></span><span class="line"><span class="cl"><span class="mi">11</span>	<span class="mi">10</span>	<span class="mf">0.1778</span>
</span></span><span class="line"><span class="cl"><span class="mi">11</span>	<span class="mi">9</span>	<span class="mf">0.4454</span>
</span></span><span class="line"><span class="cl"><span class="mi">10</span>	<span class="mi">7</span>	<span class="mf">0.2586</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span>	<span class="mi">8</span>	<span class="mf">0.2005</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span>	<span class="mi">6</span>	<span class="mf">0.2796</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span>	<span class="mi">5</span>	<span class="mf">0.5994</span>
</span></span><span class="line"><span class="cl"><span class="mi">8</span>	<span class="mi">4</span>	<span class="mf">0.48</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>	<span class="mi">2</span>	<span class="mf">0.179</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>	<span class="mi">3</span>	<span class="mf">0.3517</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>	<span class="mi">2</span>	<span class="mf">0.2289</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>	<span class="mi">2</span>	<span class="mf">0.2169</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>	<span class="mi">1</span>	<span class="mf">0.2903</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>	<span class="mi">1</span>	<span class="mf">0.422</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span>	<span class="mi">5</span>	<span class="mf">0.4402</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>	<span class="mi">4</span>	<span class="mf">0.11</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">G</span><span class="p">=</span><span class="n">graph</span><span class="p">(</span><span class="n">edges</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">edges</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">edges</span><span class="p">(:,</span><span class="mi">3</span><span class="p">));</span> <span class="c">%the Graph</span>
</span></span><span class="line"><span class="cl"><span class="c">% suppossing starting node is 1, goal node is 12</span>
</span></span><span class="line"><span class="cl"><span class="n">star_node</span> <span class="p">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">goal_node</span><span class="p">=</span> <span class="mi">12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c">%^^^^^^^^^^^ Initial graphs ^^^^^^^^</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">%-----------plot the graph------------</span>
</span></span><span class="line"><span class="cl"><span class="c">% plot the graph</span>
</span></span><span class="line"><span class="cl"><span class="n">plot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>&#34;<span class="n">XData</span>&#34;<span class="p">,</span><span class="n">nodes_positions</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span>&#34;<span class="n">YData</span>&#34;<span class="p">,</span><span class="n">nodes_positions</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span>&#34;<span class="n">LineWidth</span>&#34;<span class="p">,</span><span class="mi">3</span><span class="p">,</span>&#34;<span class="n">MarkerSize</span>&#34;<span class="p">,</span><span class="mi">10</span><span class="p">,</span>&#34;<span class="n">NodeFontSize</span>&#34;<span class="p">,</span><span class="mi">20</span><span class="p">,</span>&#34;<span class="n">EdgeLabel</span>&#34;<span class="p">,</span><span class="n">G</span><span class="p">.</span><span class="n">Edges</span><span class="p">.</span><span class="n">Weight</span><span class="p">,</span>&#34;<span class="n">EdgeFontSize</span>&#34;<span class="p">,</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% mark start and goal nodes</span>
</span></span><span class="line"><span class="cl"><span class="n">hold</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">plot</span><span class="p">(</span><span class="n">nodes_positions</span><span class="p">(</span><span class="n">star_node</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nodes_positions</span><span class="p">(</span><span class="n">star_node</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;bo&#39;</span><span class="p">,</span>&#34;<span class="n">MarkerSize</span>&#34;<span class="p">,</span><span class="mi">15</span><span class="p">,</span>&#34;<span class="n">LineWidth</span>&#34;<span class="p">,</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">plot</span><span class="p">(</span><span class="n">nodes_positions</span><span class="p">(</span><span class="n">goal_node</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nodes_positions</span><span class="p">(</span><span class="n">goal_node</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;ro&#39;</span><span class="p">,</span>&#34;<span class="n">MarkerSize</span>&#34;<span class="p">,</span><span class="mi">15</span><span class="p">,</span>&#34;<span class="n">LineWidth</span>&#34;<span class="p">,</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">hold</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% a function to plot the nodes</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span><span class="w"> </span><span class="nf">plotnodes</span><span class="p">(</span>nodeID,pos<span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">nodes_positions</span><span class="p">=</span><span class="n">pos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">hold</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">plot</span><span class="p">(</span><span class="n">nodes_positions</span><span class="p">(</span><span class="n">nodeID</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nodes_positions</span><span class="p">(</span><span class="n">nodeID</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;go&#39;</span><span class="p">,</span>&#34;<span class="n">MarkerSize</span>&#34;<span class="p">,</span><span class="mi">15</span><span class="p">,</span>&#34;<span class="n">LineWidth</span>&#34;<span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">hold</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c">%-^^^^^^^^^^plot the graph^^^^^^^^^^^^</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">%--------Breadth First Search _ with path-----------</span>
</span></span><span class="line"><span class="cl"><span class="c">%step 1,2</span>
</span></span><span class="line"><span class="cl"><span class="n">frontier</span><span class="p">={};</span><span class="c">% define the frontier nodes</span>
</span></span><span class="line"><span class="cl"><span class="n">frontier</span><span class="p">{</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">}=</span><span class="n">star_node</span><span class="p">;</span> <span class="c">% initial the start nodes as the first frontier</span>
</span></span><span class="line"><span class="cl"><span class="n">came_from</span><span class="p">=</span><span class="n">containers</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="s">&#39;KeyType&#39;</span><span class="p">,</span> <span class="s">&#39;double&#39;</span><span class="p">,</span> <span class="s">&#39;ValueType&#39;</span><span class="p">,</span> <span class="s">&#39;double&#39;</span><span class="p">);</span> <span class="c">% define reached nodes</span>
</span></span><span class="line"><span class="cl"><span class="n">came_from</span><span class="p">(</span><span class="mi">1</span><span class="p">)=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">%step 3</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">~</span><span class="nb">isempty</span><span class="p">(</span><span class="n">frontier</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c">%step 4</span>
</span></span><span class="line"><span class="cl">   <span class="n">current</span> <span class="p">=</span> <span class="n">frontier</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span> <span class="c">% add the first elements of frontier to current</span>
</span></span><span class="line"><span class="cl">   <span class="n">frontier</span><span class="p">(</span><span class="mi">1</span><span class="p">)=[];</span> <span class="c">% remove the first elements of frontier</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c">%plot the current nodes and denoted as green.</span>
</span></span><span class="line"><span class="cl">   <span class="n">plotnodes</span><span class="p">(</span><span class="n">current</span><span class="p">,</span><span class="n">nodes_positions</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c">%step 5</span>
</span></span><span class="line"><span class="cl">   <span class="c">%find the neighbors of current nodes</span>
</span></span><span class="line"><span class="cl">   <span class="n">next_node</span><span class="p">=</span><span class="n">neighbors</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">current</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c">%step 6</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">next_node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="o">~</span> <span class="n">isKey</span><span class="p">(</span><span class="n">came_from</span><span class="p">,</span><span class="n">next_node</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span> <span class="c">% if neighbor nodes is not in the reached set</span>
</span></span><span class="line"><span class="cl">           <span class="n">frontier</span><span class="p">{</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">}=</span><span class="n">next_node</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span> <span class="c">% add neighbor nodes to frontier</span>
</span></span><span class="line"><span class="cl">           <span class="n">came_from</span><span class="p">(</span><span class="n">next_node</span><span class="p">(</span><span class="nb">i</span><span class="p">))=</span><span class="n">current</span><span class="p">;</span>  <span class="c">% the value of dic is the last nodes</span>
</span></span><span class="line"><span class="cl">       <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">end</span>
</span></span><span class="line"><span class="cl">   <span class="c">% input(&#39;Press any key to continue...\n&#39;); % waiting user&#39;s action, to show each explore step</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">% % print the map</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">%     % Retrieve all keys</span>
</span></span><span class="line"><span class="cl"><span class="c">%     keySet = keys(came_from);</span>
</span></span><span class="line"><span class="cl"><span class="c">% </span>
</span></span><span class="line"><span class="cl"><span class="c">%     % Iterate through each key and print its corresponding value</span>
</span></span><span class="line"><span class="cl"><span class="c">%     disp(&#39;The map contains the following key-value pairs:&#39;);</span>
</span></span><span class="line"><span class="cl"><span class="c">%     for i = 1:length(keySet)</span>
</span></span><span class="line"><span class="cl"><span class="c">%         currentKey = keySet{i};</span>
</span></span><span class="line"><span class="cl"><span class="c">%         currentValue = came_from(currentKey);</span>
</span></span><span class="line"><span class="cl"><span class="c">%         fprintf(&#39;%d: %d\n&#39;, currentKey, currentValue);</span>
</span></span><span class="line"><span class="cl"><span class="c">%     end</span>
</span></span><span class="line"><span class="cl"><span class="c">% ^^^^^^^^Breadth First Search  _ with path^^^^^^^^^^^^</span>
</span></span></code></pre></div><p>Since MATLAB do not directly show the contents of Map, we add several lines to print the map. Printing results is shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">1<span class="p">:</span> <span class="nl">1</span>
</span></span><span class="line"><span class="cl">2<span class="p">:</span> <span class="nl">1</span>
</span></span><span class="line"><span class="cl">3<span class="p">:</span> <span class="nl">1</span>
</span></span><span class="line"><span class="cl">4<span class="p">:</span> <span class="nl">2</span>
</span></span><span class="line"><span class="cl">5<span class="p">:</span> <span class="nl">2</span>
</span></span><span class="line"><span class="cl">6<span class="p">:</span> <span class="nl">9</span>
</span></span><span class="line"><span class="cl">7<span class="p">:</span> <span class="nl">5</span>
</span></span><span class="line"><span class="cl">8<span class="p">:</span> <span class="nl">4</span>
</span></span><span class="line"><span class="cl">9<span class="p">:</span> <span class="nl">5</span>
</span></span><span class="line"><span class="cl">10: 7
</span></span><span class="line"><span class="cl">11: 9
</span></span><span class="line"><span class="cl">12: 8
</span></span></code></pre></div><p>Then we can build the path through the map:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="n">path</span> <span class="p">=</span> <span class="p">[</span><span class="n">goal_node</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">previous_node</span><span class="p">=</span><span class="n">came_from</span><span class="p">(</span><span class="n">goal_node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">previous_node</span><span class="o">~=</span><span class="n">star_node</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">=[</span><span class="n">path</span> <span class="n">previous_node</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">previous_node</span><span class="p">=</span><span class="n">came_from</span><span class="p">(</span><span class="n">previous_node</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="n">path</span><span class="p">=[</span><span class="n">path</span> <span class="n">star_node</span><span class="p">];</span>
</span></span></code></pre></div><p>Attention that, we explore all the graph, then extract the path from start to goal. However, in some case, we only need to find the goal and exit. To exit the program upon we find the goal, adding following under step 4 to the while loop:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">% if we find the goal, then exit the program.</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">current</span><span class="o">==</span><span class="n">goal_node</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span></code></pre></div><p>The path on the graph is indicated in red shown below:
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="path" srcset="
               /post/astar/path_hu5d0cc519cef4843ca486acf3a5274d66_85298_54dae6595fe48c3226fb0f8f20df3bb8.webp 400w,
               /post/astar/path_hu5d0cc519cef4843ca486acf3a5274d66_85298_4095b021ecc293e18b36d244041b250a.webp 760w,
               /post/astar/path_hu5d0cc519cef4843ca486acf3a5274d66_85298_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/path_hu5d0cc519cef4843ca486acf3a5274d66_85298_54dae6595fe48c3226fb0f8f20df3bb8.webp"
               width="760"
               height="480"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>The complete breadth first search code can be found <a href="https://github.com/JuuHuu/A-algorithm-using-MATLAB/blob/main/Breadth_first.mlx" target="_blank" rel="noopener">here</a></p>
<h4 id="dijkstras-algorithm">Dijkstra&rsquo;s Algorithm</h4>
<p>In the  <a href="#breadth-first-search">breadth first search algorithm</a>, costs are the same between nodes. However, the cost traveling from one nodes to another usually does not the same. As illustrate  in the figure below.
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="path with cost" srcset="
               /post/astar/figure2_hud5d3f3217788e55a44e2ca5430f5be88_79282_a78c017c3210d3e750be1d2cd8731dfb.webp 400w,
               /post/astar/figure2_hud5d3f3217788e55a44e2ca5430f5be88_79282_d6299afa7d2fa97160f9a81252a8c34f.webp 760w,
               /post/astar/figure2_hud5d3f3217788e55a44e2ca5430f5be88_79282_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/figure2_hud5d3f3217788e55a44e2ca5430f5be88_79282_a78c017c3210d3e750be1d2cd8731dfb.webp"
               width="760"
               height="491"
               loading="lazy" data-zoomable /></div>
  </div></figure>

Supposing you are traveling from node A to node B, and a lake in between. There are two path, where path 1 crosses the lake, path 2 on the land. Though path 1 has a shorter length, most people will choose follow path 2, because the energy (or times,etc.) cost by path 2 will less than path 1 for most people. To take the cost into path planning, we introduce Dijkstra&rsquo;s Algorithm.</p>
<p>Instead of adding all non-reached neighbors into the <em><strong>frontier</strong></em>, Dijkstra&rsquo;s Algorithm compare the cost of the next nodes, if the cost is less than current one, then it will be added into <em><strong>frontier</strong></em>.
The peudocode is shown below:</p>
<ol>
<li>Initial parameters</li>
<li>Add starting nodes and set priority =0 to <em><strong>frontier</strong></em></li>
<li>repeat following until <em><strong>frontier</strong></em> is empty</li>
<li>Move the highest priority element of <em><strong>frontier</strong></em> to <em><strong>current node</strong></em></li>
<li>Find the <em><strong>neighbors</strong></em> of <em><strong>current node</strong></em></li>
<li>Calculate the <em><strong>new_cost</strong></em> = cost_so_far(current) + cost to next node</li>
<li>If <em><strong>neighbors</strong></em> is not in <em><strong>cost_so_far</strong></em> OR new_cost &lt; cost_so_far(next)
<ol>
<li>cost_so_far[next]=<em><strong>new_cost</strong></em></li>
<li>add <em><strong>neighbor</strong></em> and <em><strong>new_cost</strong></em> to <em><strong>frontier</strong></em></li>
<li>came_from[next]=current</li>
</ol>
</li>
<li>end repeat</li>
</ol>
<p>The complete Algorithm code can be found <a href="https://github.com/JuuHuu/A-algorithm-using-MATLAB/blob/main/Dijkstra.mlx" target="_blank" rel="noopener">here</a></p>
<p>The finding process is shown below:</p>
<html>
<video id="myVideo2" controls>
  <source src="Dijkstra.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
<script>
// Set video playback speed here
document.addEventListener("DOMContentLoaded", function() {
  var video = document.getElementById("myVideo2");
  video.playbackRate = 0.1;
});
</script>
</html>
<p>The final path is shown below:
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="Dijkstra&amp;rsquo;s" srcset="
               /post/astar/path_Dijkstra_hu4041f6a8ad5c37d7dce5f957ff220c50_71298_c593e0910296948821d5f96075dd339b.webp 400w,
               /post/astar/path_Dijkstra_hu4041f6a8ad5c37d7dce5f957ff220c50_71298_70aaf4092803193636d3a8fc12f19ee3.webp 760w,
               /post/astar/path_Dijkstra_hu4041f6a8ad5c37d7dce5f957ff220c50_71298_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/path_Dijkstra_hu4041f6a8ad5c37d7dce5f957ff220c50_71298_c593e0910296948821d5f96075dd339b.webp"
               width="760"
               height="490"
               loading="lazy" data-zoomable /></div>
  </div></figure>

Obviously, the path is different from breadth first search when adding the cost.</p>
<h4 id="heuristic-search-greedy-best-first-search">Heuristic search (Greedy Best First Search)</h4>
<p>In breadth first algorithm and Dijkstra&rsquo;s algorithm, the frontier is expanded in all directions. However, a common case is we know the direction, and we only want to find the path to that direction. Here introducing Heuristic search.</p>
<p>Heuristic search also maintain an <em><strong>frontier</strong></em>, however, different from breadth search, heuristic search algorithm use heuristic cost  and search the highest priority neighbor first. Heuristic cost ususllay the distance from current nodes to the goal nodes.</p>
<p>The pseudocode is show below:</p>
<ol>
<li>Initial parameters</li>
<li>Add starting nodes and set priority =0 to <em><strong>frontier</strong></em></li>
<li>repeat following until <em><strong>frontier</strong></em> is empty</li>
<li>Move the highest priority element of <em><strong>frontier</strong></em> to <em><strong>current node</strong></em></li>
<li>Find the <em><strong>neighbors</strong></em> of <em><strong>current node</strong></em></li>
<li>If <em><strong>neighbors</strong></em> is not in <em><strong>came_from</strong></em>
<ol>
<li>calculate heuristic cost from <em><strong>neighbors</strong></em> to goal</li>
<li>add <em><strong>neighbor</strong></em> and heuristic cost to <em><strong>frontier</strong></em></li>
<li>came_from[next]=current</li>
</ol>
</li>
<li>end repeat</li>
</ol>
<p>The complete code can be found <a href="https://github.com/JuuHuu/A-algorithm-using-MATLAB/blob/main/heuristic.mlx" target="_blank" rel="noopener">here</a></p>
<p>The explore process is quiet straightforward, one way to the goal. Noting that the cost beside the edge is not used in heuristic algorithm, instead we use the heuristic cost.
the final path is shown below:
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="heuristic search" srcset="
               /post/astar/heuristic_hu939fab7e2c95046e08d3f2e09ead991b_75238_24f0647c39deb465c824d35372efb8c7.webp 400w,
               /post/astar/heuristic_hu939fab7e2c95046e08d3f2e09ead991b_75238_56db64692ae043f9b57e827fdb2918ec.webp 760w,
               /post/astar/heuristic_hu939fab7e2c95046e08d3f2e09ead991b_75238_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/heuristic_hu939fab7e2c95046e08d3f2e09ead991b_75238_24f0647c39deb465c824d35372efb8c7.webp"
               width="760"
               height="425"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>The algorithm runs faster when edges is quiet straightforward to the goal. However, when there are many &ldquo;dead end&rdquo;, the paths are not as good.</p>
<p>The figure shown below demonstrate the graph with &ldquo;dead end&rdquo;. The starting node is 1 and goal node is 12. The heuristic algorithm first explore 1-6-11, because it is the most straightforward path from start node to goal node, However, it meets a dead end. Then follow 1-2-3-4-8-12 path to find the goal.
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="dead end" srcset="
               /post/astar/path_Dijkstra_dead_hu167fcb61b32e8e2f8de4a2f7020730b9_25499_9b49269de543243766e6f22a13ad33af.webp 400w,
               /post/astar/path_Dijkstra_dead_hu167fcb61b32e8e2f8de4a2f7020730b9_25499_341a24af30669068a71dd6093fc670ad.webp 760w,
               /post/astar/path_Dijkstra_dead_hu167fcb61b32e8e2f8de4a2f7020730b9_25499_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/path_Dijkstra_dead_hu167fcb61b32e8e2f8de4a2f7020730b9_25499_9b49269de543243766e6f22a13ad33af.webp"
               width="504"
               height="378"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p><strong>A brief summary:</strong></p>
<p><a href="#breadth-first-search">Breadth first search algorithm</a></p>
<ol>
<li>explore the graph in all direction uniformly.</li>
</ol>
<p><a href="#dijkstras-algorithm">Dijkstra&rsquo;s algorithm</a></p>
<ol>
<li>explore the graph in all direction uniformly;</li>
<li>consider the cost of edge.</li>
</ol>
<p><a href="#heuristic-search-greedy-best-first-search">Heuristic search algorithm</a></p>
<ol>
<li>explore the graph towards the goal direction.</li>
</ol>
<p>So is there any algorithm combine the Dijkstra&rsquo;s algorithm and Heuristic search algorithm, that explore the graph towards the goal direction, also consider the cost? That is A* algorithm</p>
<h4 id="a-algorithm">A* algorithm</h4>
<p>A* algorithm combine the advantages of Heuristic and Dijkstra&rsquo;s, it&rsquo;s very similar to Dijkstra&rsquo;s algorithm, just add the heuristic cost to the priority.</p>
<p>The peudocode is shown below:</p>
<ol>
<li>Initial parameters</li>
<li>Add starting nodes and set priority =0 to <em><strong>frontier</strong></em></li>
<li>repeat following until <em><strong>frontier</strong></em> is empty</li>
<li>Move the highest priority element of <em><strong>frontier</strong></em> to <em><strong>current node</strong></em></li>
<li>Find the <em><strong>neighbors</strong></em> of <em><strong>current node</strong></em></li>
<li>Calculate the <em><strong>new_cost</strong></em> = cost_so_far(current) + cost to next node</li>
<li>If <em><strong>neighbors</strong></em> is not in <em><strong>cost_so_far</strong></em> OR new_cost &lt; cost_so_far(next)
<ol>
<li>cost_so_far[next]=<em><strong>new_cost</strong></em></li>
<li>add <em><strong>neighbor</strong></em> and <em><strong>new_cost + heuristic cost</strong></em> to <em><strong>frontier</strong></em></li>
<li>came_from[next]=current</li>
</ol>
</li>
<li>end repeat</li>
<li></li>
</ol>
<p>The complete code can be found <a href="https://github.com/JuuHuu/A-algorithm-using-MATLAB/blob/main/Astar.mlx" target="_blank" rel="noopener">here</a></p>
<p>The result is shown below:
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="A_star" srcset="
               /post/astar/Astar_hu69b3007a94e4dfb9829c365aedede7ca_60027_60de4f8ce67d3bcfb07f896bd0c6b83c.webp 400w,
               /post/astar/Astar_hu69b3007a94e4dfb9829c365aedede7ca_60027_38c1739dfd5736faa97c0f93c28f216b.webp 760w,
               /post/astar/Astar_hu69b3007a94e4dfb9829c365aedede7ca_60027_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/post/astar/Astar_hu69b3007a94e4dfb9829c365aedede7ca_60027_60de4f8ce67d3bcfb07f896bd0c6b83c.webp"
               width="760"
               height="481"
               loading="lazy" data-zoomable /></div>
  </div></figure>

compare to Dijkstra, the A* do not explore the nodes that not in the goal directions (e.g. node 9).</p>
<h2 id="summary">Summary</h2>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#breadth-first-search">Breadth first</a></td>
<td>explore all the direction uniformly</td>
<td>waste time</td>
</tr>
<tr>
<td><a href="#dijkstras-algorithm">Dijkstra&rsquo;s</a></td>
<td>consider edge cost, explore all directions</td>
<td>waste time</td>
</tr>
<tr>
<td><a href="#heuristic-search-greedy-best-first-search">Heuristic</a></td>
<td>explore goal direction</td>
<td>may not find the shortest way</td>
</tr>
<tr>
<td><a href="#a-algorithm">A*</a></td>
<td>explore goal direction, consider cost</td>
<td>relay on estimate cost</td>
</tr>
</tbody>
</table>
<ol>
<li>A* is good, but it relay on the estimate cost from current node to goal nodes. If estimate cost is larger than real cost, it may not return the shortest path.</li>
<li>When the estimate cost become smaller, A* turn into Dijkstra&rsquo;s: No direction is shown. When the estimate cost become larger, A* turn into Heuristic: estimate cost become dominate and the influence of real costs are too small, it does not influence the path searching process.</li>
<li>Cost value and heuristic value can be vary in different circumstance. How to define and calculate them may difficult.</li>
</ol>
<h2 id="reference">Reference</h2>
<ol>
<li>A* Search Algorithm. In Wikipedia, April 6, 2024. <a href="https://en.wikipedia.org/w/index.php?title=A" target="_blank" rel="noopener">https://en.wikipedia.org/w/index.php?title=A</a>*_search_algorithm&amp;oldid=1217507422.</li>
<li>Patel, Amit J. Introduction to the A* Algorithm. Red Blob Games, 2014. <a href="https://www.redblobgames.com/pathfinding/a-star/introduction.html" target="_blank" rel="noopener">https://www.redblobgames.com/pathfinding/a-star/introduction.html</a>.</li>
</ol>

              </div>
              





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/matlab/">MATLAB</a>
  
  <a class="badge badge-light" href="/tag/algorithm/">Algorithm</a>
  
  <a class="badge badge-light" href="/tag/robotics/">Robotics</a>
  
  <a class="badge badge-light" href="/tag/path-planning/">Path Planning</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fjuuhuu.github.io%2Fpost%2Fastar%2F&amp;text=A%2A&#43;Algorithm&#43;Using&#43;MATLAB" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fjuuhuu.github.io%2Fpost%2Fastar%2F&amp;t=A%2A&#43;Algorithm&#43;Using&#43;MATLAB" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=A%2A%20Algorithm%20Using%20MATLAB&amp;body=https%3A%2F%2Fjuuhuu.github.io%2Fpost%2Fastar%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fjuuhuu.github.io%2Fpost%2Fastar%2F&amp;title=A%2A&#43;Algorithm&#43;Using&#43;MATLAB" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=A%2A&#43;Algorithm&#43;Using&#43;MATLAB%20https%3A%2F%2Fjuuhuu.github.io%2Fpost%2Fastar%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fjuuhuu.github.io%2Fpost%2Fastar%2F&amp;title=A%2A&#43;Algorithm&#43;Using&#43;MATLAB" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://juuhuu.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu5ef897290a630dfddddc10e3b1125d43_231572_270x270_fill_q75_lanczos_center.jpg" alt="Jun Hu"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://juuhuu.github.io/">Jun Hu</a></h5>
      <h6 class="card-subtitle">Ph.D. Student</h6>
      <p class="card-text">My research interests include distributed robotics, mobile computing and programmable matter.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/juuhuu" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>

















            </div>
        </article>
  
      </main>
    </div>
  </div>
  
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  <p class="powered-by copyright-license-text">
     2024 Me.
  </p>
  





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a>  the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.ff7771056d34ad9f2de2d8f6a466e748.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>








  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.7f5ebaff62ae468cff8bb3dd1337bb9b.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9c0e895144aef5a693008b5c5d450147.js" type="module"></script>


















</body>
</html>
